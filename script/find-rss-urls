#!/usr/bin/env ruby
require 'open-uri'
require 'nokogiri'
require 'uri'

if ARGV.empty?
  warn "Usage: find-rss-urls <url>"
  exit 1
end

url = ARGV[0]

begin
  # Fetch page content
  html = URI.open(url).read
rescue OpenURI::HTTPError => e
  warn "Failed to fetch URL: #{e.message}"
  exit 1
end

# Parse HTML
doc = Nokogiri::HTML(html)

# Find RSS/Atom feed links
rss_links = doc.css('link[type="application/rss+xml"], link[type="application/atom+xml"]').map do |link|
  href = link['href']
  # Make relative URLs absolute
  URI.join(url, href).to_s
end

if rss_links.empty?
  warn "No RSS feeds found on this page."
  exit 1
else
  rss_links.each { |feed| puts feed }
end
